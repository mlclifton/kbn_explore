# Phase 3 Implementation Plan: Data Analysis (v2)

## 1. Objective

To implement Phase 3 of the project by creating a script that analyzes the data generated by the automated trials. The analysis will validate the performance of the keyboard-based navigation system and include a comparison against the principles of Fitts's Law, as outlined in the functional specification.

This version of the plan incorporates the user-suggested improvement of randomizing the target size for each trial to better simulate real-world conditions.

## 2. Strategy

The core of this phase is to create a standalone Node.js script that ingests the CSV data from the Phase 2 trial runner and outputs a comprehensive analysis report to the console. This maintains a clean separation between data generation and data analysis.

To perform a meaningful analysis that includes Fitts's Law, we must first enhance the data collected during the automated trials. The analysis script will then use this richer dataset to perform its calculations.

The final analysis will consist of three parts:
1.  **Descriptive Statistics:** A high-level summary of performance.
2.  **Frequency Distribution:** A histogram showing the spread of performance across all trials.
3.  **Fitts's Law Analysis:** A breakdown of performance based on the difficulty of the trial, which directly addresses a key part of the project's validation plan.

## 3. Implementation Plan

### Step 1: Enhance Data Collection

The current trial runner only outputs the number of moves. To perform a Fitts's Law analysis, we need more context for each trial. This step also includes the logic for randomizing the target size.

-   **Task:** Add `TARGET_SIZE_RATIO_MIN` and `TARGET_SIZE_RATIO_MAX` constants to `js/config.js` to define the range for random target sizes.
-   **Task:** Modify the `generateRandomTargetBox` function in `js/geometry.js` to generate a random width and height based on the new config settings.
-   **Task:** Modify the `createInitialState` function in `js/simulation.js` to calculate and store the initial distance to the target (`D`) and the target's width (`W`).
-   **Task:** Update `js/automated_trials.js` to include `initial_distance`, `target_width`, and `moves` in its results array.
-   **Task:** Update the `formatResultsToCSV` function to include the new data points in the CSV header and rows.

### Step 2: Create the Analysis Script

-   **Task:** Create a new file named `js/analysis.js`.
-   **Task:** Implement logic to read data from `process.stdin`, allowing it to receive the piped output from the `npm run trials` command.
-   **Task:** Implement a CSV parser within the script to convert the raw CSV string into an array of structured JavaScript objects.

### Step 3: Implement Statistical Analysis

-   **Task:** Create a function to calculate and display descriptive statistics for the `moves` data:
    -   Total Trials
    -   Mean (Average)
    -   Median
    -   Mode
    -   Min & Max
    -   Standard Deviation
-   **Task:** Create a function to calculate and display a frequency distribution (histogram) for the number of moves, showing how many trials were completed in 1 move, 2 moves, 3 moves, etc.

### Step 4: Implement Fitts's Law Analysis

-   **Task:** For each trial in the dataset, calculate the Fitts's Law **Index of Difficulty (ID)** using the formula: `ID = log2(D/W + 1)`, where `D` is the initial distance and `W` is the target width.
-   **Task:** Group trials by their calculated ID (rounded to the nearest integer for simplicity).
-   **Task:** For each ID group, calculate the average number of moves.
-   **Task:** Display the results in a table, showing the clear relationship between the Index of Difficulty and the average moves required.

### Step 5: Streamline Execution

-   **Task:** Add a new `analysis` script to `package.json` that pipes the output of the `trials` script into the new analysis script. The command will be: `"analysis": "npm run trials | node js/analysis.js"`.
-   **Task:** Add a new `analysis:file` script to `package.json` that saves the trial data to a file and then runs the analysis script on that file. The command will be: `"analysis:file": "npm run trials > trials.csv && node js/analysis.js < trials.csv"`. This provides an alternative workflow and allows the raw data to be inspected.